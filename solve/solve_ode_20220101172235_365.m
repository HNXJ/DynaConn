function [T,L1I_v,L1I_iNa_m,L1I_iNa_h,L1I_iK_n,L2I_v,L2I_iNa_m,L2I_iNa_h,L2I_iK_n,L3I_v,L3I_iNa_m,L3I_iNa_h,L3I_iK_n,L1E_v,L1E_iNa_m,L1E_iNa_h,L1E_iK_n,L2E_v,L2E_iNa_m,L2E_iNa_h,L2E_iK_n,L3E_v,L3E_iNa_m,L3E_iNa_h,L3E_iK_n,Input1_v,Input1_iNa_m,Input1_iNa_h,Input1_iK_n,Input2_v,Input2_iNa_m,Input2_iNa_h,Input2_iK_n,L1I_L1E_iAMPA_s,L1E_L1I_iGABA_s,L2I_L1I_iGABA_s,L1I_L2I_iGABA_s,L2E_L1E_iAMPA_s,L1E_L2E_iAMPA_s,L2I_L2E_iAMPA_s,L2E_L2I_iGABA_s,L3E_L2E_iAMPA_s,L3I_L2I_iGABA_s,L2E_L3E_iAMPA_s,L2I_L3I_iGABA_s,L3I_L3E_iAMPA_s,L3E_L3I_iGABA_s,L2E_Input1_iAMPA_s,L2I_Input2_iAMPA_s,L1I_v_spikes,L2I_v_spikes,L3I_v_spikes,L1E_v_spikes,L2E_v_spikes,L3E_v_spikes,Input1_v_spikes,Input2_v_spikes,L1E_L1I_iGABA_IGABA,L1E_L2E_iAMPA_IAMPA,L1I_L1E_iAMPA_IAMPA,L1I_L2I_iGABA_IGABA,L2E_Input1_iAMPA_IAMPA,L2E_L1E_iAMPA_IAMPA,L2E_L2I_iGABA_IGABA,L2E_L3E_iAMPA_IAMPA,L2I_Input2_iAMPA_IAMPA,L2I_L1I_iGABA_IGABA,L2I_L2E_iAMPA_IAMPA,L2I_L3I_iGABA_IGABA,L3E_L2E_iAMPA_IAMPA,L3E_L3I_iGABA_IGABA,L3I_L2I_iGABA_IGABA,L3I_L3E_iAMPA_IAMPA,L1I_L1E_iAMPA_netcon,L1E_L1I_iGABA_netcon,L2I_L1I_iGABA_netcon,L1I_L2I_iGABA_netcon,L2E_L1E_iAMPA_netcon,L1E_L2E_iAMPA_netcon,L2I_L2E_iAMPA_netcon,L2E_L2I_iGABA_netcon,L3E_L2E_iAMPA_netcon,L3I_L2I_iGABA_netcon,L2E_L3E_iAMPA_netcon,L2I_L3I_iGABA_netcon,L3I_L3E_iAMPA_netcon,L3E_L3I_iGABA_netcon,L2E_Input1_iAMPA_netcon,L2I_Input2_iAMPA_netcon]=solve_ode

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% random_seed was set to shuffle earlier. 

% ------------------------------------------------------------
% Fixed variables:
% ------------------------------------------------------------
L1I_L1E_iAMPA_netcon = [+2.467252234802118e-01   +1.553185745702197e-01   +1.209180691709626e-01   +4.411287935512555e-02   +7.034903793638751e-02   +5.228344445434240e-02   +1.178149175211579e-03   +1.949883910546848e-01   +1.678087576463354e-01   +1.408638823747917e-01   +3.902081944410045e-02   +3.640874005843138e-01   +2.225803520716062e-01   +1.448101848959671e-01   +1.171316677300727e-01   +2.596706032041181e-01; +2.202648342923150e-01   +7.902111024040692e-02   +2.549183257971162e-01   +1.499097116992561e-01   +3.669545458543098e-01   +2.781835179863534e-01   +1.771276768380216e-01   +2.584146412120602e-01   +2.527019943107589e-01   +4.022128355437392e-01   +3.769640793675815e-01   +1.410471413038549e-01   +2.048219335208406e-01   +1.519586498326272e-02   +2.562275466555696e-01   +7.644276203192386e-02; +1.856194285810582e-01   +3.811298985993590e-01   +1.186807363032726e-01   +4.874711535054871e-02   +2.190321064896796e-01   +4.051138454645184e-01   +2.446345518934702e-01   +1.692542358508809e-01   +2.681767188631932e-01   +1.111062963958400e-01   +1.451182267810441e-01   +1.591348217179935e-01   +2.683040519240255e-01   +1.897681115324169e-01   +3.394954136384132e-01   +2.736336801610070e-01; +7.096861652496785e-02   +2.665287928612078e-01   +3.197260863150430e-01   +4.515105992109411e-02   +2.865656621227539e-01   +1.569779436094086e-01   +6.067595691696355e-02   +7.948139228377298e-02   +3.225464471774202e-01   +1.502350952559822e-01   +5.589733168791140e-02   +1.779556802796891e-01   +3.278218326823917e-01   +2.163671573667995e-01   +3.940517736080442e-01   +2.143303680439035e-01; +8.528687717316444e-02   +3.425083206117676e-01   +2.130490200005360e-01   +3.375557510438707e-01   +3.076459350473389e-01   +1.599255586643578e-01   +4.904173882798259e-02   +1.012500263375027e-01   +1.220003687099542e-01   +2.801859227691225e-01   +2.828810007245334e-01   +2.862322664572630e-01   +1.589590868018249e-01   +2.993906366185520e-01   +1.516461799977615e-02   +5.817254644632846e-02; +9.710544628727800e-02   +3.744019761718378e-01   +1.580193795833807e-01   +2.275441013950859e-01   +2.814749203062031e-01   +6.078355232306769e-02   +2.111971098861471e-01   +2.252402501850324e-01   +4.479894969707251e-02   +2.310209929255945e-01   +1.262600035686993e-02   +9.456971855893849e-02   +9.706392481098289e-03   +3.397452219852824e-01   +2.369037639967284e-01   +1.877838343659395e-01; +3.516636636901764e-01   +2.656975897085608e-01   +2.484502317629017e-01   +2.775806620443942e-01   +2.102410347150302e-01   +1.630487726420621e-01   +6.246015585005568e-02   +2.990343260984287e-01   +8.328391445445001e-02   +1.669130908498545e-01   +6.188346005544596e-02   +7.308290301092396e-02   +1.767446579451452e-01   +3.199536847673676e-02   +1.045002797938458e-01   +2.804689588952430e-01; +5.591540102234665e-02   +7.682650881191050e-02   +2.620675317256930e-01   +3.415156934916131e-01   +2.255603346713523e-01   +8.016700280326888e-02   +6.773090203051524e-02   +6.382610186308171e-02   +2.894010067097618e-01   +1.769852055269693e-02   +3.155288094046063e-01   +2.369812275013070e-01   +1.591094926473398e-01   +3.907169600849942e-01   +2.220845081614197e-01   +4.696422902755636e-02; +4.460898044522189e-02   +2.065089697432438e-02   -8.852755422959560e-04   +7.340104655652267e-02   +1.965384157272329e-01   +3.979635763609697e-01   +3.058417651139754e-01   +2.044310365269282e-01   +1.609854757094864e-01   +3.401858519681938e-01   +8.019918770591994e-02   +9.275088562362037e-02   +1.499740319513989e-01   +3.081508015158178e-01   +1.883810164113311e-01   +2.718097339612593e-01; +1.203028517579775e-01   +5.767646645239309e-02   +2.243027209918393e-01   +2.446816839075289e-01   +3.145270107934104e-01   +6.373229736706380e-02   +5.166892663644015e-02   +3.820260356464628e-01   +3.266622294914562e-02   +2.122559933171106e-01   +1.653830684651078e-01   +3.498829718730624e-01   +3.678868838200213e-01   +1.767146072291110e-01   +4.548107206188201e-02   +3.415925708297907e-02; +1.502512207344921e-01   +2.479505474088134e-01   +1.124961199509523e-01   +2.830285366563161e-02   +1.061025484928010e-01   +2.642737236314768e-01   +3.357422939032699e-01   +2.728527576988941e-01   +2.577645598722492e-01   +2.789986649380013e-02   +1.296836861329573e-01   +4.157383671437198e-01   +1.750971133825356e-01   +2.286183279601970e-01   +1.673015116813688e-01   +3.432517544369615e-01; +1.977247649117070e-01   +1.302808716901995e-01   +4.020066148361114e-01   +2.352479318098369e-02   +9.594661219083925e-02   +4.065020148661889e-01   +1.388803764391471e-01   +3.351384596266064e-01   +3.178486818522765e-02   +2.149814901618595e-01   +3.336596021450317e-01   +3.121784621647973e-01   +1.391470737952299e-01   +3.576806874573744e-01   +2.377244259499983e-01   +2.142726013983935e-01; +4.040942608882467e-02   +2.902413373845122e-01   +2.258984879835882e-01   +6.880542760389030e-02   +9.618152105980057e-02   +3.032947713085359e-01   +9.927731921425309e-02   +3.480112427022264e-01   +1.855837602207963e-01   +3.622380001973936e-01   +2.938713686301380e-01   +1.971215121241697e-01   +1.510792174317404e-01   +6.485177868041563e-02   +1.011612736271215e-01   +1.685378369192853e-01; +8.511776662844188e-02   +3.498510440419301e-01   +3.507939424695296e-01   +3.304406315811008e-01   +3.264043170418665e-01   +7.089479167999399e-02   +9.214224826896665e-02   +1.836407280529706e-01   +2.969519288618587e-01   +2.285658117096120e-01   +3.529355727612660e-01   +6.891875327715825e-02   +1.140259297713081e-01   +1.221756469473130e-01   +1.485606455713724e-01   +1.920905797531988e-01; +1.446699522601307e-01   +3.597132471309603e-02   +2.070116088944964e-01   +2.684524709564300e-01   -5.235016306702687e-03   +1.913094153560514e-01   +1.974527784859424e-01   +8.794048488665175e-02   +2.080989031862592e-01   +8.662711065878782e-02   +6.545869448638511e-02   +3.027422298634230e-01   +2.838069198227860e-02   +2.428291542416936e-01   +3.208903415249743e-01   +2.434042534884656e-01; +7.099999614114763e-03   +6.977644736767265e-02   +3.223418553577236e-01   +2.715398054813275e-02   +1.913540960977934e-01   +5.279950643209927e-03   +2.651846286281634e-01   +2.112864346966367e-01   +3.871634314716592e-01   +1.748268863351795e-01   +1.979524979749157e-01   +3.220809019408751e-01   +2.602875985748725e-01   +2.118478793861804e-01   +1.303819884963126e-01   +2.794720750101747e-01];
L1E_L1I_iGABA_netcon = [+1.511036591649783e-01   +3.261976303054611e-02   +8.241934705279941e-02   +3.742227098182750e-01   +2.887904652131705e-01   +1.407455627113269e-01   +2.225856100453725e-01   +3.662762937553237e-01   +1.227296064143883e-01   +2.455376237954147e-01   +1.733087751059752e-01   +2.309603959694541e-01   +4.022303191554807e-01   +9.230864611776551e-02   +3.921848509704843e-01   +2.376564286470661e-01; +7.656723798451880e-03   +3.497958976811980e-01   +2.159245306808747e-01   +1.705219165799730e-01   +8.274549335222280e-02   +2.774794550722366e-01   +8.803911876166437e-02   +2.740358348490688e-01   +2.863824968060960e-01   +2.365105432895304e-01   +2.931398663737592e-01   +1.187358600104917e-01   +3.255089085014000e-01   +2.101622612405130e-01   +3.842425280667821e-01   +2.565467829199462e-01; +2.845124349902137e-01   +3.588173857347823e-01   +1.697288816041606e-01   +2.871829425014505e-01   +2.038324492808171e-01   +3.036294278678025e-01   +9.667465275841430e-03   +1.640867805460983e-01   +1.397213498521950e-01   +3.497372089171311e-01   +1.140317943805136e-01   +2.370642028082879e-01   +2.945639203816399e-01   +2.273196773911512e-01   +1.317099543555707e-01   +4.047462014383794e-02; +2.733251183536393e-01   +3.704056798324953e-01   +2.256274545237949e-01   +2.807663609453918e-01   +6.307674799638524e-02   +2.876984643658368e-01   +2.203477184701387e-02   +2.848888339502971e-01   +2.414425409215144e-01   +3.014391304873499e-01   +1.714945610083888e-02   +7.459151128006518e-03   +2.743952330487917e-01   +1.019290895112867e-01   +4.810996202968613e-02   +1.983885223250843e-01; +1.942292214061562e-01   +2.740112896156946e-01   +1.774795730391366e-01   +1.142954785956374e-01   +2.555006051253911e-01   +2.593674659670204e-01   +2.064265197312021e-01   +2.003675048003745e-02   +2.453389257511117e-01   +1.509307895108606e-01   +5.567632884663490e-02   +9.356961502769777e-02   +5.934205964164776e-02   +2.346048320918769e-01   +1.899859247707797e-01   +2.398215543201050e-01; +1.263798669551848e-01   +3.367152772698347e-02   +7.972966502405508e-02   +2.331446136045770e-01   +2.461283846618114e-01   +3.242408770062690e-01   +1.393364458244041e-01   +2.255927624497981e-01   +2.837673190092329e-01   +2.317107475791946e-01   +2.160411351557879e-01   +2.748910455641169e-01   +3.636722779089241e-02   +3.305089207064911e-01   +5.162565764945869e-02   +1.693207218415451e-01; +6.322808011756517e-02   +1.694932764412544e-01   +3.134138328398578e-01   +3.397887091410138e-01   +1.457505929641433e-01   +7.529937236517913e-02   +8.304137935764526e-03   +7.762271679744102e-02   +2.073529557933681e-01   +2.174560720381347e-01   +3.498542145738961e-01   +2.167715182714380e-02   +3.506534599810385e-01   +2.442247001348073e-01   +2.237545631584376e-01   +3.424693164106794e-02; +1.278975107028235e-01   +3.309337217920117e-01   +8.521983156726218e-02   +3.547143184533925e-01   +8.356864134453244e-02   +7.407928431957150e-02   +3.331785208968733e-01   +6.177009551593594e-02   +9.299630050318246e-03   +1.733673037440189e-02   +1.791511219799040e-01   +3.228705910971329e-01   +2.659082222534760e-01   +3.143918496454435e-01   +3.659480234966876e-01   +1.212614816106409e-01; +7.436388162721914e-02   +3.856281297214655e-01   +3.112339165670041e-01   +3.077718357827701e-01   +3.438626401596733e-01   +1.302652443015792e-01   +2.086332457713602e-01   +2.552747027090059e-02   +2.834845768979695e-01   +6.819528186314469e-03   +2.858757844937221e-01   +3.279211683431373e-01   +3.353963476709284e-01   +8.249296631051480e-02   +2.189645701598531e-01   +4.077246791144778e-01; +3.333303672301154e-02   +2.434644856409642e-01   +3.768116408191360e-01   +7.921250246379859e-02   +1.727208132675757e-01   -4.499325154570906e-03   +1.670389997817014e-01   +3.328138346520824e-01   +3.947757420773883e-01   +5.384523222442087e-02   +1.208809148650328e-01   +1.855738435058025e-01   +1.746832304735312e-02   +8.636382772683911e-03   +2.628166677050734e-01   +4.726832360119029e-02; +2.847592803349324e-01   +2.775107671568853e-01   +6.347323375364973e-02   +3.437630382039683e-01   +2.236816203018792e-01   +8.646827209391360e-02   +2.102291373115926e-01   +9.170663826945345e-02   +3.444440394396442e-01   +6.102605695983579e-02   +2.190155138284865e-01   +7.394346144356002e-02   +9.314327757825461e-02   +1.229106289231457e-02   -6.971507722200458e-03   +2.289480070109909e-01; +1.208157612339095e-02   +2.941586640716315e-01   +3.669228746378287e-02   +2.756072848607339e-01   +3.706903221244478e-01   +1.916394192131978e-01   +1.580982063117828e-01   +3.635962234530154e-01   +3.826900134762907e-01   +3.828266433723798e-01   +3.562031741425037e-01   +3.780066016058770e-01   +2.850713006438092e-02   +2.418648400291003e-03   +3.490248000092160e-01   +1.503674096795792e-01; +3.477069890085826e-01   +2.838134262117154e-01   +5.137643989272122e-02   +1.561183468477107e-02   +2.635689846282222e-01   +2.665621686851323e-01   +2.155037587697835e-01   +1.934347444242860e-01   +2.867063567464583e-01   +1.380354853322042e-02   +2.988957315788159e-01   +5.181298288986354e-02   +9.086771685098502e-02   +1.095792052475692e-01   +2.363287221920968e-01   +1.277499928887835e-01; +2.431954869907894e-01   +2.317525887353394e-01   +3.250054747233192e-01   +1.747369667649972e-01   +1.282686432035470e-01   +5.730137076384588e-02   +2.399703533861306e-02   +1.668011774253433e-01   +8.334424452262561e-02   +2.436634211664437e-02   +2.456352618904824e-01   +2.086934332224953e-01   +1.101669095334137e-01   +3.231373662253761e-02   +1.248534656851208e-01   +8.335680812350825e-02; +1.893367301761366e-01   +4.053581154186964e-01   +2.449128778667312e-01   +2.531878859009242e-01   +2.447522083032503e-01   +1.060855712003341e-01   +1.828270644393886e-01   +2.202862223705996e-01   +3.502169629950719e-01   +2.636643500220837e-01   +2.727719284308320e-03   +3.054155046551476e-01   +4.310290628916874e-02   +2.580084535823726e-02   +1.819469643672226e-01   +1.616064974536006e-01; +2.942118307740763e-01   +2.870710205455265e-01   +5.520105845710309e-02   +2.246156409495667e-01   +1.045580758490081e-01   +1.603237974224795e-02   +5.660415517465459e-02   +3.560003484451858e-01   +9.377087003072176e-02   +2.963352501161619e-01   +2.884660887786476e-01   +2.445897058733322e-01   +1.732983586756857e-01   +3.645536890478152e-01   +1.446473369680631e-02   +3.844118595338090e-01];
L2I_L1I_iGABA_netcon = [+8.613542465019611e-02   +2.363893122736801e-01   +3.634875771404333e-01   +9.864149954751125e-03   +2.987190979048946e-01   +8.111607650142177e-02   +6.009767302495204e-02   +3.554380086678929e-01; +1.188015070425994e-01   +3.458863341350357e-01   +7.748255607562836e-02   +2.200065127393569e-01   +1.954998323363894e-03   +1.660040469316023e-01   +3.435409162882641e-01   +2.231212710674177e-01; +4.053143005231892e-02   +2.488740175276732e-02   +2.096993175891826e-01   +4.037363457528300e-01   +2.684892350382863e-01   +3.351424683931949e-01   +9.974392736840516e-03   +3.505406768574520e-01; +6.749121886581302e-02   +4.161911883374754e-01   +1.329310620130238e-02   +3.792709807089293e-02   +5.332902422751718e-02   +2.175764666789089e-02   +1.088457922721061e-01   +3.286062884389052e-02; +1.231584408755153e-01   +3.781496804387982e-01   +2.787201117018378e-01   +9.939845657402661e-02   +3.957682023926500e-01   +7.912587082368509e-02   +2.397381973208578e-01   +2.571251139216205e-01; +3.277782412996853e-01   +3.721798780624656e-01   +1.525406228491763e-01   +3.718058510068033e-01   +2.485263241421876e-01   +2.617320504151474e-01   +1.470824194081227e-01   +1.341117087997871e-01; +5.476867346396098e-02   +2.138862387781416e-01   +1.399848570385742e-01   +3.480422500001859e-02   +5.496109107532229e-02   +6.613538331243067e-02   +6.888199504744225e-02   +1.116131316115008e-01; +1.428305740376948e-01   +1.543421011554816e-01   +2.616100005535635e-01   +2.731009244334436e-01   +2.296922472207731e-02   +4.010185738090251e-01   +2.109756521911893e-01   +9.569660468306503e-02; +2.707128425150259e-01   +4.982571616386239e-02   +3.735877030791437e-01   +4.607599408538032e-02   +1.794283327940753e-01   +1.073596719875726e-01   +1.992285351272052e-01   +3.883410217229467e-01; +2.095521927662054e-01   +3.256805441031846e-01   +2.854043505244764e-01   +2.831639190217855e-01   +2.686967515997350e-01   +5.405416119276151e-02   +2.445857781052395e-01   +1.076680602121442e-01; +1.677733647978131e-01   +3.506855708698254e-01   +2.581834065092821e-01   +2.560653051998978e-01   +3.440815541746819e-01   +3.140914108029906e-01   -8.627175666408313e-04   +3.956642263793605e-01; +3.797206396951787e-01   +8.360033195042187e-02   +1.832731282256627e-01   +3.987027522699084e-01   +3.574338205062143e-01   +1.743365182044112e-01   +2.360736170890707e-01   +3.919460970716462e-01; +2.836905422907131e-01   +2.319832313317810e-01   +2.382481049406631e-01   +3.609395137989256e-01   +1.729117460386351e-01   +1.037600334128576e-01   +1.474818349939542e-01   +1.238929846825136e-01; +6.287446816176037e-02   +4.019380629519679e-01   +3.867805090505351e-01   +2.896888616362981e-01   +1.163295311439625e-01   +3.749395832923444e-02   +9.687440792877468e-02   +1.865306945135754e-01; +2.486186966271581e-01   +3.013744424499698e-01   +9.750849204200950e-02   +2.837415684744497e-02   +1.516599671734511e-01   +4.575782154436833e-02   +3.291069612750477e-01   +9.005875789600383e-02; +4.003451196799490e-02   +1.701320629472018e-01   +3.065701391875876e-01   +3.934270297461412e-03   +3.745552253029103e-01   +2.601916705356834e-01   +2.340128691932097e-01   +1.825308676889401e-01];
L1I_L2I_iGABA_netcon = [+1.248239243636143e-01   +1.094605415448677e-01   +1.274952007478316e-01   +2.472849647182540e-01   +2.692295101633294e-01   +1.397792821143962e-01   +9.490458139159411e-02   +3.015599671693392e-01   +1.508225745216587e-01   +1.613030637682492e-01   +2.833800138214113e-01   +8.662982900663665e-02   +1.679813645474795e-01   +2.850552419746543e-01   +3.489529960232717e-01   +3.274519898859721e-01; +2.950543121056573e-01   +2.281663004979598e-01   +3.594895395960331e-01   +2.705734579847967e-01   +3.884199880037371e-01   +1.290706703499700e-02   +2.224864341012224e-01   +1.076353414907377e-01   +1.378538636248498e-01   +6.368080837275589e-02   +3.818259988944802e-01   +2.943282232563030e-01   +3.839656777776023e-01   +3.170358178044252e-01   +1.903974900882471e-01   +2.921460384464931e-02; +2.246222304022046e-01   +2.516860664383695e-01   +2.901247188620182e-01   +2.441313379485094e-01   +1.857304220039629e-02   +3.283385593668712e-01   +5.572844010063409e-03   +1.992763184430741e-01   +4.040836080234891e-01   +5.983550756987094e-02   +1.431296214712048e-01   +2.268897337405305e-01   +6.612894001451558e-02   +3.766884087302699e-01   +2.256172622238520e-01   +3.374950729848342e-01; +1.157867884630598e-01   +1.238237335767247e-02   +1.382438087650400e-01   +1.114296903096771e-01   +2.704268073967109e-01   +2.777259005193949e-02   +2.079003463863997e-01   +1.491581993922129e-01   +3.741560605605994e-01   +3.071230107036677e-01   +2.809357309873783e-01   +1.481381954777791e-01   +3.149702157874053e-01   +3.617946118273839e-01   +1.722518489281831e-01   +1.756844190692204e-01; +2.503302211732331e-02   +3.339857436838122e-01   +6.841788185288136e-02   +1.318753649537338e-01   +1.831147412557898e-01   +2.819886094998626e-01   +3.849460421731856e-01   +3.736049293769858e-01   +3.465099912731835e-01   +1.560276889148166e-01   +2.389537214723569e-03   +2.033767975105661e-01   +7.647621516238674e-02   +3.056573697768771e-01   +7.641829654468789e-02   +3.221772533162106e-01; +3.107225268412035e-01   +9.034138100215194e-02   +2.401320864038982e-01   +1.654713378938484e-01   +3.468672644737327e-01   +1.309403856918204e-01   +8.780324555362115e-02   +3.550368087258950e-02   +1.154907706315267e-01   +2.751917032131686e-01   +4.040226273017662e-01   +6.218012593905214e-02   +2.556419771926575e-02   +1.727471333163649e-02   +2.356042593665734e-01   +1.818667839647201e-01; +2.819881848915166e-01   +2.966180221764957e-01   +8.379874053998551e-03   +3.872320071184061e-02   +2.694392025622397e-01   +3.867457677805766e-01   +9.957744890670570e-03   +3.423155377609056e-01   +4.035919514383591e-03   +3.841109017765260e-01   +3.101954653882743e-01   +2.555630064096702e-01   +2.161770077659392e-01   +3.217546840750374e-02   +2.689631515291694e-01   +3.615695973442831e-01; +3.725276434717875e-01   +3.385448815898870e-01   +3.846087755283936e-01   +1.557926946137330e-01   +5.568435136588530e-02   +2.054338995849143e-01   +1.404068377242198e-01   +2.340630884280814e-01   +8.168941090110224e-02   +1.191550292141923e-01   +2.899979043887735e-01   +1.504203235220370e-01   +3.052337927986666e-01   +1.030138251572590e-01   +1.573233563480875e-02   +1.746632525344008e-01];
L2E_L1E_iAMPA_netcon = [+3.483457158602476e-01   +2.351699117606609e-01   +2.253109039567030e-01   +3.939671298277895e-02   +4.006163246524972e-01   +1.597413754976202e-01   +3.230738477221021e-01   +2.017901897626107e-01; +3.669016393056438e-01   +7.225865590459234e-02   +3.537463946030449e-01   +4.010879463918509e-01   +3.276622592832976e-01   +1.497290757055558e-01   +1.239212394581862e-01   +1.095560279558884e-01; +2.581674925398988e-02   +3.476397853203647e-01   +3.559055396048575e-01   +1.658095713457661e-02   +1.451604665607157e-01   +1.034521402498109e-01   +3.842216688748984e-01   +3.701432069888765e-01; +1.299241166797400e-02   +1.154550160758840e-02   +3.593425226853361e-01   +1.650639795679560e-01   +2.685716608601704e-01   +1.516438087855075e-01   +3.065937428891148e-01   +2.158274532291515e-01; +1.503407289865414e-01   +1.419543475803051e-01   +1.448802734862480e-01   +1.374227297164951e-01   +3.263315832713768e-01   +3.592293556540416e-01   +1.398815390468842e-01   +4.307404985798066e-02; +3.827009277089909e-01   +2.853936205011571e-01   +2.083730401820270e-01   +2.570968416503744e-01   +2.758121095148195e-01   +6.429863331344855e-02   +4.192333425079489e-02   +2.011266245025583e-01; -8.630826999609089e-04   +9.517526574408912e-02   +3.333509489109619e-01   +7.746939047218734e-02   +5.094780594844241e-02   +3.686810229092497e-01   +3.310042541033708e-01   +5.637761901213627e-02; +3.274509494564168e-01   +2.163864682595349e-02   +3.987729080942797e-02   +3.360190065395416e-01   +2.750603878717027e-01   +3.467966958498749e-01   +2.638424233414131e-01   +2.075474998185824e-01; +1.419104522008211e-01   +4.013666975853964e-01   +7.046548741255138e-02   +1.369572955389802e-01   +3.334372978414860e-01   +2.615246513087711e-01   +1.254378336254050e-01   +2.169209603688382e-01; +4.670162490975607e-02   +3.003838755986377e-01   +3.153139370181706e-01   +3.768849974242660e-01   +3.977459147468414e-01   +2.071078429234838e-01   +3.741160602449801e-01   +3.255030161378752e-01; +2.128196172603878e-01   +1.726000811515369e-01   +3.270318334188175e-01   +2.747266911012951e-01   +2.361127406435364e-01   +3.189884664702836e-02   +2.492998276156418e-01   +3.096217204909493e-01; +2.913684780471333e-01   +2.482531849639393e-01   +3.526227726802363e-01   +3.685172490057746e-01   +2.674650462159112e-02   +1.925500505658642e-01   +2.178417691589469e-01   +2.468716019922246e-01; +8.903085154626503e-02   +6.062407720327422e-02   +3.398809159888818e-01   +1.769086345486119e-01   +3.100768661658881e-01   +2.059728298319329e-01   +3.929357150306548e-01   +3.777906370641638e-01; +2.817727377036156e-02   +2.433833983619441e-01   +1.081458682037514e-01   +1.506552658320321e-01   +3.848342706357059e-01   +1.527810534325532e-01   +3.186620211721470e-01   +2.625142846331782e-01; +9.056334751205901e-02   +1.558316745843723e-01   +4.194522249022294e-02   +1.859293082039463e-03   +6.725327810851237e-02   +5.651588577738099e-02   +1.382588775477571e-01   +3.859688187734489e-01; +9.494566484619260e-02   +2.410236072538913e-02   +5.046102095824664e-02   +2.691712463626680e-02   +2.772172022923045e-01   +7.990322903107204e-02   +1.256666329872466e-01   +3.636255223554700e-01];
L1E_L2E_iAMPA_netcon = [+3.322002888346018e-01   +1.466299537776048e-01   +2.536453063380221e-01   +4.041515685878224e-01   +3.544354640796071e-01   +9.229786424843674e-02   +2.956777656796714e-01   +1.264435832726172e-02   +3.278142189286161e-01   +2.306221969409370e-01   +1.136889147673341e-01   +1.866500253411074e-01   +1.382433215617766e-01   +3.657452747588489e-01   +4.017487560152954e-01   +6.240676037217258e-02; +3.720454273420299e-01   +3.226563303447443e-01   +2.216858312216077e-01   +1.477369749653164e-01   +2.363258906318209e-01   +1.698032826182910e-01   +2.253912468331781e-01   +1.077987704822343e-01   +4.115961824612633e-01   +2.770440823132903e-01   +3.819983554528646e-01   +3.332639252752118e-01   +8.315888081320316e-03   +2.709575241683160e-01   +2.766542623084311e-01   +1.674471852930887e-01; +3.392165676105992e-01   +1.973015282473319e-01   +1.313186965232332e-01   +4.012495202727643e-01   +3.212099107963582e-01   +3.236666963656756e-01   +8.415616962597688e-02   +2.339874349959635e-01   +1.764007850486020e-01   +1.545592047787815e-01   +2.632614755008293e-01   +1.283585141548083e-01   +9.592963003625927e-03   +4.352091063998064e-02   +2.173341616074443e-01   +2.031062646948668e-01; +1.250981946886449e-01   +2.097163221514262e-01   +2.527199891395118e-01   +2.668349749350826e-01   +3.450608389702032e-01   +2.350155624749338e-01   +3.568838922461779e-01   +1.269790276472706e-01   +1.209811712435155e-01   +7.113562557375866e-02   +3.105330810187387e-01   +1.739095484777047e-01   +3.120404999749959e-01   +8.881982847592763e-02   +3.870011964579822e-01   +6.444057641864878e-02; +2.910213192295183e-01   +1.570477316771871e-01   +2.581514538002956e-02   +3.544614520968778e-01   +5.279531656297894e-02   +3.662978590897751e-01   +2.841005781059165e-01   +2.314136742631065e-02   +2.122803591324413e-01   +1.115796483085170e-02   +3.578050911045961e-01   +6.209494518217502e-02   +2.790878938963551e-01   +1.541835133730143e-01   +1.923903036644222e-01   +2.436849707756771e-01; +3.956557864875513e-01   +3.274240841673625e-01   +3.769276201387305e-01   +1.624999128451209e-01   +3.301549854386622e-01   +2.252564792705475e-01   +2.662474677274131e-01   +3.778509578775902e-01   +1.423853044516785e-01   +3.107122866183255e-01   +3.570130014437873e-01   +2.775877997305882e-02   +8.413604610911629e-02   +1.932065831582400e-01   +7.028754870346685e-02   +2.483401032199066e-01; +1.539827775776589e-01   +3.454824904509185e-01   +1.236965712299744e-01   +4.062729256153917e-01   +1.924272580717048e-01   +2.577149119754110e-01   +3.650490842784768e-01   +1.653023197168903e-01   +9.147150008309343e-02   +4.068082241345515e-01   +7.421650877800963e-02   +3.713671287549329e-01   +3.267861514625228e-01   -4.280058576363459e-03   +1.377978482365382e-01   +2.539707117755092e-01; +1.010624442549992e-02   +4.032450813392907e-01   +1.565282205871959e-01   +2.043209651621478e-01   +1.234779516639223e-02   +1.084797032966542e-01   +2.356462958219317e-01   +9.808773744207561e-02   +3.035622696165412e-03   +2.834787506822630e-02   +3.265127307302363e-01   +2.284842336562158e-01   +2.444533426892357e-01   +3.346869975637997e-01   +3.392568698353662e-01   +7.232517264960153e-02];
L2I_L2E_iAMPA_netcon = [+1.703502098182794e-01   +1.385770065513803e-01   +3.406644165122318e-01   +2.154297431274085e-01   +2.074270251480303e-01   +1.233299611255790e-01   +4.040892931682127e-01   +1.968519372625471e-01; +2.534789576563801e-02   +3.206632791018205e-01   +2.566826333914902e-01   +3.920359870317765e-01   +6.916328867829576e-02   +3.248544111165214e-01   +4.095406619470375e-01   +2.900419224272811e-01; +3.711569512384880e-01   +2.788886409199356e-01   +1.501549994762761e-01   +3.199579735583907e-01   +4.826381818655702e-02   +2.997842943374903e-01   +1.904568004936970e-01   +4.756444316891567e-02; +3.126829194713828e-02   +2.026005202245246e-01   +2.605802486608144e-02   +9.260696096635769e-02   +1.594881493256490e-02   +1.947092068494180e-01   +3.111380922782428e-01   +3.942617612769583e-01; +2.252781778527287e-01   +1.882482694996883e-02   +2.933799682722574e-01   +1.515055856936831e-02   +1.013661179765158e-01   +3.784489513472829e-01   +7.282657180520508e-02   +2.816430802062994e-01; +1.757794549671998e-01   +3.445943389195840e-01   +7.061438104631446e-02   +1.389755570143084e-01   +2.500891924928317e-01   +1.939567628543123e-01   +8.413957180157351e-02   +3.270053592308906e-02; +2.473683000568532e-01   +1.613765634012790e-02   +1.739610945783528e-01   +3.473147297148116e-01   +2.866917719334101e-02   +2.023469725742936e-02   +2.363005199000773e-01   +5.013074297670644e-02; +1.211282401184667e-01   +6.661853777170103e-02   +2.934537816752065e-01   +2.131021428010230e-01   +1.019007134984573e-01   +2.895715304056376e-01   +2.243797342065489e-01   +4.989474203193480e-02];
L2E_L2I_iGABA_netcon = [+1.871143876325047e-01   +4.040478640984165e-01   +1.140293602149167e-01   +3.606588742822750e-01   +2.291486757017013e-01   +1.887420332159220e-01   +3.730809817072372e-01   +2.713507092943746e-01; +3.074866022476151e-01   +6.140606309352373e-02   +1.826128654507193e-01   +3.168574097009058e-01   +1.969875158149861e-01   +7.472687763902093e-02   +3.542334554949071e-01   +3.628315834929796e-01; +2.117070695641587e-01   +2.051487704328809e-01   +2.533069503098277e-01   +1.311145276470597e-01   +2.914310571507714e-01   +3.021624910323485e-01   +3.039741930148683e-01   +1.883940731569156e-01; +1.648864507010125e-01   +2.493933083895999e-01   +1.060531946272354e-01   +3.482444032259943e-01   +4.157209159063763e-01   +3.568344930017966e-01   +2.899435574914774e-01   +3.691798972577944e-01; +1.353281578332810e-01   +3.766754560647825e-01   +1.658701213264496e-02   +3.346509037102435e-01   +1.192587331451917e-01   +2.351715170042064e-01   +9.132973861012894e-02   +1.788061392916782e-01; +3.347029057127833e-01   +8.725522457547202e-02   +1.588429324576319e-02   +1.923672089499422e-01   +2.123194358220197e-01   +2.307543455019993e-01   +2.360584328580149e-01   +1.341145604368611e-01; +3.889189912584966e-02   +1.785076449858705e-01   +1.290911983361691e-01   +2.767469814670744e-01   +2.576973667194501e-01   +3.467126216015383e-01   +1.955771965420781e-01   +9.382129252252072e-02; +3.135041161337619e-01   +2.190130052835160e-01   +3.811230282269084e-01   +9.152564946712843e-02   +3.074952818203041e-01   +1.366008155511977e-01   +1.597795784961293e-02   +2.703917003933584e-01];
L3E_L2E_iAMPA_netcon = [+8.309157538484269e-02   +2.321423950207198e-01   +2.554238914421825e-01   +1.005173352598525e-01   +2.863184000234411e-01   +1.362612461727334e-01   +3.482944059140485e-01   +2.491207598762839e-01   +4.056063552322535e-01   +2.982520612350139e-01   +1.958215829790002e-01   +3.019966430932338e-01; +3.133819637286619e-01   +9.810763647421127e-02   +2.183230948957408e-01   +2.454253960384586e-01   +3.771712647201254e-01   +4.090706252183246e-02   +3.768502444749728e-01   +1.858605001527878e-01   +2.003192109539778e-01   +8.408818095475749e-03   +1.951978936783908e-01   +8.624416850123903e-02; +2.827358632120001e-01   +2.559346957275104e-01   +5.306707287138570e-02   +3.404985627478872e-01   +7.280147275260392e-02   -2.668269025404203e-03   +3.821993307439690e-01   +2.925085191475789e-01   +1.553520507806874e-01   +3.046925869823277e-01   +1.304202404615225e-01   +1.112943070394724e-02; +2.169164498806219e-01   +2.589152999268214e-01   +3.933579163068832e-01   +1.982761155051751e-02   +3.262324124405504e-01   +4.170626193352443e-02   +9.294678037455298e-02   +9.845042189840811e-02   +2.817871508703294e-01   +1.134798072873545e-01   +3.301874277242309e-02   +3.066205727566860e-01; +1.434861934241624e-01   +7.967058237500975e-02   +1.116146515586781e-01   +1.667170007847008e-01   +2.787727597294749e-01   +2.055325148299086e-01   +2.340577521074037e-01   +3.150759005306889e-01   +2.546044806978148e-01   +1.127463194269162e-01   +2.700138911960040e-01   +2.051265265365802e-01; +2.408335757444881e-01   +3.485739796378217e-01   +1.392065791979596e-01   +3.618380889533815e-01   +4.329989268362876e-02   +1.233667632257391e-01   +3.965770266075387e-01   +1.537746326606791e-01   +2.720871798979224e-01   -1.519534455422807e-03   +1.357414749966920e-01   +4.084434224632960e-01; +2.886164855707902e-01   +2.601669153688662e-01   +3.047651310912934e-01   +3.885965911272720e-01   +3.605012256111496e-01   +1.874494527976829e-01   +2.473871485405999e-01   +1.145598767768842e-01   +1.539562431367856e-01   +5.654986033620098e-02   +1.991110093761384e-01   +8.966089043859778e-02; +2.260339899485256e-01   +3.513851728260106e-01   +1.266931590225827e-01   +1.984778711225497e-01   +3.013539312966595e-01   +1.085360918002572e-01   +2.104999445771274e-01   +9.387518508784386e-02   +1.312738962179232e-01   +4.053212102984772e-03   +3.747372865283259e-01   +5.320179764312643e-02];
L3I_L2I_iGABA_netcon = [+1.368856008310255e-01   +9.111566056541331e-02   +3.223705040084662e-01   +2.001307909193140e-01   +3.499318507263258e-02   +2.487730621917049e-01   +1.393901462438255e-01   +1.580861464219782e-01   +4.041705816149199e-01   +2.012222354880012e-01   +3.492873302837652e-01   +3.001290123276127e-01; +1.618377428842126e-01   +2.091400207791772e-02   +2.685309784076503e-01   +2.678541949283011e-01   +4.014349565244855e-01   +1.936907475637380e-01   +2.487805325125313e-01   +4.041401480392238e-01   +1.502498683604668e-01   +8.812428750843870e-02   +2.771815723573476e-01   +2.524533785264579e-01; +1.808116518968127e-01   +2.760081691323686e-02   +2.337098299581205e-01   +1.797727964790193e-01   +3.152797190011426e-01   +2.586038417603158e-01   +1.347304066043165e-01   +3.746802667759980e-01   +2.734960529825827e-01   +1.787958266951853e-01   +2.989959492046600e-01   +1.885764524005239e-01; +2.089702922063610e-01   +9.064893756379988e-02   +2.793468193196311e-01   +5.579477304626219e-02   +2.457374543817165e-01   +2.528131286691845e-01   +1.222795906694832e-01   +2.888477885124763e-01   +2.985040284349666e-01   +4.088907379084128e-02   +1.531609326143863e-01   +3.539575491055800e-01; +3.401153986734741e-01   +1.615298814150453e-01   +2.954534372285689e-01   +3.315965787546140e-01   +2.898932371524844e-01   +2.786779833873002e-01   +3.555694328461959e-02   +1.916682994037410e-01   +6.132868068054318e-02   +2.704181045933063e-02   +1.153907910795512e-01   +4.861697004542614e-02; +7.092096680934379e-02   +1.541333157059411e-01   +3.549874959148726e-01   +2.366798264932063e-01   +5.392761390859464e-02   +3.457866515460726e-01   +1.738053654986539e-01   +9.664167012937026e-02   +6.827498901254868e-02   +3.003311067963099e-01   +9.263450981843163e-02   +2.123241004766598e-01; +3.713179433736726e-01   +3.865893352437950e-01   +1.209321177954197e-01   +2.632001983936452e-01   +8.148126383624445e-02   +9.380534310817591e-02   +1.359499304869642e-01   +1.424058688263511e-01   +4.454980733229751e-02   +2.561395854372859e-01   +1.948307678204824e-01   +4.039227953280230e-01; +3.928994563432999e-01   +1.128862560204335e-01   +2.504469717936632e-02   +3.273896147176217e-01   +3.959739069691803e-01   +3.969156052857555e-01   +2.666402618345221e-01   +1.606003468303367e-01   +1.068134709122913e-01   +2.848196580503916e-01   +1.574531575950189e-01   +1.383085142887261e-01];
L2E_L3E_iAMPA_netcon = [+3.997108536987399e-01   +7.808762325984341e-02   +1.519226139163386e-01   +3.262014343187337e-01   +2.275940265191728e-01   +3.115959278248574e-01   +2.360243372349047e-01   +1.844859473718784e-01; +4.453410522453091e-02   +5.302824503492331e-02   +1.729927456810954e-01   +1.542189242462620e-01   +5.949426346361503e-02   +2.476254244545383e-01   +2.872905784337000e-01   +3.749446857832269e-01; +5.611739614900320e-02   +1.859655494017242e-01   +3.232664681236408e-01   +3.548625885487716e-01   +4.003642119000056e-01   +1.070081899661273e-01   +3.910068861830313e-01   +1.817950315678217e-01; +3.831556726270092e-01   +3.632762104298590e-01   +2.001924160305447e-01   +3.702623354567297e-01   +2.060373616457938e-01   +2.754490578034910e-01   +3.156344168215768e-01   +4.016885839978701e-01; +3.541951755796181e-01   +4.065417581657721e-01   -4.125825728388205e-03   +2.076772138518255e-01   +2.857244841666117e-02   +3.948667863765710e-02   +1.467541846260930e-01   +2.810511256358452e-01; +3.814543441061570e-01   +3.057469344571746e-01   +1.924353588983544e-01   +2.918266613426217e-01   +2.016519090270338e-01   +2.481555115781511e-01   +8.624223141189688e-02   +1.331772694655587e-01; +5.768668971628209e-02   +2.875516169022752e-01   +2.099964504845139e-01   +3.527565717098655e-02   +1.939616970564835e-03   +1.248479889575480e-02   +9.251874000439314e-02   +1.986181619320623e-01; +1.632278965237844e-01   +1.837029551993245e-01   +2.168571403688801e-01   +3.155202024276018e-01   +1.331845779565077e-01   +2.723931782106558e-01   +8.037190972040031e-02   +2.464489409659055e-01; +3.563840303430139e-01   +4.627719058878253e-02   +3.937100956542317e-01   +1.587987913601603e-02   +3.323646992836172e-01   +2.051896931126927e-01   +2.023499823276962e-01   +3.474352518125309e-01; +1.667021810732343e-01   +1.625457915526316e-01   +2.517359994834139e-01   +2.315617150562178e-01   +3.219816463392566e-01   +2.708597143283191e-01   +2.463161963960531e-01   +3.759177793459816e-01; +5.416161142944775e-02   +3.034803540455078e-01   +1.578114823175232e-01   +1.797228759313089e-01   +2.676578770546773e-01   +1.756337927910559e-01   +1.771941141512301e-01   +1.953645377041181e-01; +1.067814748452143e-02   +2.794322083673433e-01   +2.981532257768124e-01   +2.340686967795776e-01   +2.718319839793026e-01   +3.057622113858270e-01   +1.720343003338387e-01   +6.521911148863382e-02];
L2I_L3I_iGABA_netcon = [+1.449699428871247e-02   +2.710982560415258e-01   +1.805616856159194e-01   +3.338420594411493e-01   +2.456004909595428e-01   +1.281794428287917e-01   +2.444330595315337e-01   +2.488356195674579e-02; +1.619857370960161e-01   +2.379640609474300e-01   +6.920388490848647e-03   +2.943133311789023e-01   +3.679275212109042e-01   +2.951737873865724e-01   +3.222669179646596e-01   +1.719975059078490e-01; +1.748158938637673e-01   +3.503027122570062e-01   +2.777518450105677e-02   +9.054896002484102e-02   +1.393154645692870e-01   +1.608603092201132e-01   +1.254246419470992e-01   +1.714230614543604e-01; +1.950098891557135e-01   +3.150108853867805e-01   +4.093049963283161e-02   +4.083040583604739e-01   -2.453469705428992e-03   +4.063686484378402e-01   +1.712493525209476e-01   +3.207940525555046e-01; +2.623526018197577e-01   +2.957133030630093e-01   +5.373056522714369e-02   +3.467805573335686e-01   +2.168514591686243e-01   +7.781797976767106e-02   +2.749109074565125e-01   +1.542604287402349e-01; +2.731254034573978e-01   +1.429662699446784e-01   +2.626276785289574e-01   +3.857971952716431e-01   +2.793205601584876e-01   +7.821966266551229e-02   +2.682048673169050e-01   +6.481846464387975e-02; +1.478707705800620e-01   +3.118155264962928e-01   +4.028070801431115e-02   +2.502218696722858e-02   +1.092660590387739e-01   +3.198387598963790e-01   +2.504036681328700e-01   +2.174857232482386e-01; +3.564441269076582e-01   +2.528530786902029e-01   +1.219204298546544e-01   +1.968128606680121e-01   +2.839310531908507e-01   +3.369513191488804e-01   +2.253390707143993e-01   +2.222246950770212e-01; +1.369393216801857e-01   +2.572902710685793e-01   +1.869104443611904e-01   +8.835662881387904e-02   +1.961720801783789e-01   +2.705529381263531e-01   +1.814900251544141e-01   +1.753923752455158e-01; +3.268439585911052e-01   +1.719288280883476e-02   +1.321359105335977e-01   +1.827175863957282e-01   +2.432171839011729e-01   +1.820567938790536e-01   +1.019761491310111e-01   +2.508105183388024e-01; +1.189382904551036e-01   +1.807801718201013e-01   +3.227078415745522e-01   +5.649074232217557e-02   +2.480331548943910e-01   +1.802004722274769e-02   +2.940107492910595e-01   +1.577541730815500e-01; +3.602570105705739e-01   +3.118873145241761e-01   +3.165562321287467e-01   +1.003653309615095e-01   +4.019195779794409e-01   +4.548793036066113e-02   +2.523880788621706e-01   +1.383368146558054e-01];
L3I_L3E_iAMPA_netcon = [+3.318434483004185e-02   +2.535651732052432e-01   +1.878301268334343e-01   +1.819319145024340e-01   +1.258019781914080e-01   +1.094448081595499e-01   +9.913713625105178e-02   +2.407509796259786e-01   +2.916173140181659e-01   +2.142163665125710e-01   +1.075262793699060e-01   +2.641396557154924e-01; +2.253566816200898e-01   +2.798211398187365e-01   +2.054312415255500e-01   +3.270994022368595e-01   +1.864284316442424e-01   +2.858806476477420e-01   +3.899374087893512e-01   +2.189614327961056e-01   +1.229394490419178e-01   +1.647445767452317e-01   +4.365596839114192e-02   +4.038362618681724e-01; +3.410652697357717e-01   +3.442725429934834e-01   +2.104411775424158e-01   +3.440252998937705e-01   +3.335046642985886e-01   +3.426099555475492e-01   +8.962586166195363e-02   +4.268036161305245e-02   +3.406386911191223e-01   +2.253604161382054e-01   +9.994036374238416e-02   +1.143669252845134e-01; +1.591162476807944e-01   +1.782978043474075e-01   +4.839941846044633e-02   +9.469997133686626e-02   +3.417872492429256e-02   +1.596223671589309e-01   +3.169127714800642e-01   +7.207213025984795e-02   +2.004928118235825e-01   +1.688179785121030e-01   +2.737325106771083e-01   +1.267902827659847e-01; +1.979866564123718e-01   +2.745526092585480e-01   +2.461081731640759e-01   +9.048749824212114e-02   +1.936338064593297e-01   +1.128640241192828e-01   +3.994332457405866e-02   +9.334304678901771e-02   +5.314369918946451e-02   +3.355297771351738e-02   +1.211957087644117e-01   +2.623004537892416e-01; +6.401879926005806e-02   +9.668926682987281e-02   +1.506389663410518e-02   +2.203095911315596e-01   +1.753042650730262e-01   +1.175809673684432e-01   +9.636831174822551e-02   +1.980336594492391e-01   +1.273931975574896e-01   +7.090032026519009e-02   +3.038492362764899e-01   +3.764694816595735e-01; +2.404595642718285e-01   +3.608693331916848e-01   +4.718301351519590e-02   +3.823690479500725e-01   +3.533243191070146e-01   +1.777770097829950e-01   +1.865170014263941e-01   +7.494986004509163e-02   +1.363500495892359e-01   +2.939538350577617e-01   +9.909686539710869e-02   +3.994917373345355e-01; +3.387074663631656e-02   +2.714034597214859e-01   +1.500730507812367e-01   +3.824098519398907e-01   +3.879363398769287e-01   +2.856198189728594e-01   +3.198150945374507e-01   +1.387210457089265e-01   +6.731954755900707e-02   +2.226469508791926e-01   +1.055703160767827e-01   +7.761045447067283e-02; +1.141084035160936e-01   +2.754245979079685e-01   +1.379923221483594e-01   +7.220658245702370e-02   +2.313741365778084e-01   +2.576824379581278e-01   +3.419355111088748e-01   +3.187801952327646e-01   +2.815859471642200e-01   +3.942788018680890e-01   +1.321945484857827e-01   +6.311739818293766e-02; +1.302691102476117e-01   +7.274520772367153e-02   +6.200804423192006e-02   +1.528513678877727e-03   +1.312125264643813e-01   +6.406463714647352e-02   +1.550492106376772e-01   +7.101165607557731e-02   +3.289224449643080e-01   +3.644560054241684e-01   +2.046271591932725e-01   +1.602816454713555e-02; +6.457029599369191e-02   +1.668110578969758e-01   +3.466719827196084e-01   +6.734492054632221e-02   +3.728612004902407e-01   +2.377649632527332e-01   +2.962724154289053e-01   +4.060089625827764e-01   +6.535076760357383e-02   +3.804102827357656e-02   +2.222981839009143e-01   +4.064672051201015e-01; +3.257122703182913e-01   +2.661317117907090e-01   +3.073961357541218e-01   +3.341524842414339e-01   +3.920607907899136e-01   +3.824382845305826e-01   +2.346380419470397e-01   +1.696749774528845e-01   +3.339939930975427e-01   +8.295499579772424e-02   +2.317921986037244e-01   +2.416341597755026e-01];
L3E_L3I_iGABA_netcon = [+1.679212107532244e-01   +1.259104936664955e-01   +8.360675421514864e-02   +4.010797356983685e-01   +2.887805821883871e-01   +3.422347701459927e-01   +2.310071441536836e-01   +1.131537377526474e-01   +1.146849752702166e-01   +3.763275004080976e-01   +3.715520503468098e-01   +2.093305399078260e-01; +1.390974987238474e-01   +2.705809329661550e-01   +1.066768506921826e-01   +4.525976350229508e-02   +2.301662105756059e-01   +3.633705246562942e-01   +4.248824620667894e-02   +3.144146763530736e-01   +1.759496658247371e-01   +2.402061840162669e-01   +2.011473975766734e-01   +7.410282042129451e-02; +2.845950058878008e-01   +1.707566660123466e-01   +2.464325918206627e-02   +7.174103978870539e-02   +1.228766020183545e-01   +3.323209132470633e-01   +2.699752813557894e-01   +2.201926311247583e-01   +3.345076815074843e-01   +2.599729173950751e-01   +4.235645178861312e-02   +1.756288858757414e-01; +9.496121192519275e-02   +2.189422624162508e-01   +7.096336223243349e-02   +8.218814153901374e-02   +1.109164660378894e-01   +3.453105071458427e-01   +9.393694025841669e-02   +2.944312304209700e-01   +3.862345569587814e-01   +3.164748771400093e-01   +3.565283610764622e-01   +2.766655966667639e-01; +2.676571032675595e-02   +7.973207733455504e-03   +3.341646856016828e-01   +2.590105641041008e-01   +3.928511790269247e-01   +2.069511423687188e-01   +2.323820657814321e-01   +3.572682503174150e-01   +2.937444165179561e-01   +2.173342161576211e-01   +2.066615939220934e-01   +1.660700183345434e-02; +2.044827741572656e-01   +8.970050727630453e-02   +1.901033691068892e-01   +1.225152861549115e-01   +2.774193686183889e-01   +1.189083269543239e-01   +2.744383975811465e-01   +1.425997442977003e-01   +4.062935245542916e-01   +9.979273287495790e-03   +2.679212370463528e-01   +2.213940547533360e-01; +3.378504603862053e-01   +3.000686602938026e-01   +1.109946027732120e-01   +5.402853479531831e-02   +1.554551065575495e-01   +1.742108261201328e-01   +2.832393463837873e-01   +1.130877623311042e-01   +2.965063054051564e-02   +3.555824378348093e-01   +1.804920290685771e-01   +7.822796857572280e-02; +1.457113911584731e-01   +4.014589490629377e-01   +2.247928035590104e-01   +2.481785124966363e-03   +1.696825173040562e-01   +8.882629169543819e-02   +4.094541257590110e-02   +3.769660361605283e-01   +3.255476656982447e-01   +6.173464250074495e-02   +2.437712364464446e-01   +1.973198114215671e-01; +2.186000548974844e-01   +1.390503016198113e-01   +3.837437924044033e-01   +6.765228490441683e-02   +3.803518833271952e-01   +1.713773126717757e-01   +8.337303578004311e-02   +2.735255462524448e-02   +2.418184678927498e-01   +3.999322352494414e-01   +9.735504023219484e-03   +1.754592137221850e-01; +1.273739839668166e-01   +1.878130025800241e-01   +3.008025527077514e-01   +6.724714702745668e-02   +7.612954299784667e-03   +2.065643073791025e-01   +6.572004070241222e-02   +1.805396990172936e-01   +1.149215139571520e-01   +1.281873376398020e-02   +7.118169538717187e-02   +2.682960803895945e-01; +2.186275658813769e-01   +7.741513787324084e-02   +2.115862620151812e-01   -1.167305886695871e-03   +1.417373019141513e-01   +2.831050325202271e-01   +3.387559279544680e-01   +1.677535833234317e-02   +3.894819625463385e-01   +1.627418409432509e-01   +3.423371204379420e-01   +2.820369935027071e-02; +2.935084345227154e-02   +2.781781016756034e-01   +1.641893871465270e-01   +1.659529884078683e-01   +3.424061187074366e-01   +2.350173932559044e-01   +1.006773574568348e-01   +2.834838931978877e-01   +1.210448077193159e-01   +2.695342543083118e-01   +1.357790283290894e-01   +1.873056082632227e-01];
L2E_Input1_iAMPA_netcon = [+8.807764387816527e-02   +4.000802646348398e-01   +3.650235034771336e-01   +2.320216595851728e-01   +2.161181026265368e-01   +1.986253686435139e-01   +3.166790194157081e-01   +1.553543134345120e-02];
L2I_Input2_iAMPA_netcon = [+1.035383954237885e-01   +2.904669406283208e-01   +2.606311320501463e-01   +3.371058039259946e-01   +1.677884794186668e-01   +1.452690616479159e-01   +3.190909075985263e-01   +1.379890676519931e-01];

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;

% STATE_VARIABLES:
L1I_v_last = zeros(1,p.L1I_Npop);
L1I_v = zeros(nsamp,p.L1I_Npop);
L1I_v(1,:) = L1I_v_last;
L1I_iNa_m_last = p.L1I_iNa_m_IC+p.L1I_iNa_IC_noise*rand(1,p.L1I_Npop);
L1I_iNa_m = zeros(nsamp,p.L1I_Npop);
L1I_iNa_m(1,:) = L1I_iNa_m_last;
L1I_iNa_h_last = p.L1I_iNa_h_IC+p.L1I_iNa_IC_noise*rand(1,p.L1I_Npop);
L1I_iNa_h = zeros(nsamp,p.L1I_Npop);
L1I_iNa_h(1,:) = L1I_iNa_h_last;
L1I_iK_n_last = p.L1I_iK_n_IC+p.L1I_iK_IC_noise*rand(1,p.L1I_Npop);
L1I_iK_n = zeros(nsamp,p.L1I_Npop);
L1I_iK_n(1,:) = L1I_iK_n_last;
L2I_v_last = zeros(1,p.L2I_Npop);
L2I_v = zeros(nsamp,p.L2I_Npop);
L2I_v(1,:) = L2I_v_last;
L2I_iNa_m_last = p.L2I_iNa_m_IC+p.L2I_iNa_IC_noise*rand(1,p.L2I_Npop);
L2I_iNa_m = zeros(nsamp,p.L2I_Npop);
L2I_iNa_m(1,:) = L2I_iNa_m_last;
L2I_iNa_h_last = p.L2I_iNa_h_IC+p.L2I_iNa_IC_noise*rand(1,p.L2I_Npop);
L2I_iNa_h = zeros(nsamp,p.L2I_Npop);
L2I_iNa_h(1,:) = L2I_iNa_h_last;
L2I_iK_n_last = p.L2I_iK_n_IC+p.L2I_iK_IC_noise*rand(1,p.L2I_Npop);
L2I_iK_n = zeros(nsamp,p.L2I_Npop);
L2I_iK_n(1,:) = L2I_iK_n_last;
L3I_v_last = zeros(1,p.L3I_Npop);
L3I_v = zeros(nsamp,p.L3I_Npop);
L3I_v(1,:) = L3I_v_last;
L3I_iNa_m_last = p.L3I_iNa_m_IC+p.L3I_iNa_IC_noise*rand(1,p.L3I_Npop);
L3I_iNa_m = zeros(nsamp,p.L3I_Npop);
L3I_iNa_m(1,:) = L3I_iNa_m_last;
L3I_iNa_h_last = p.L3I_iNa_h_IC+p.L3I_iNa_IC_noise*rand(1,p.L3I_Npop);
L3I_iNa_h = zeros(nsamp,p.L3I_Npop);
L3I_iNa_h(1,:) = L3I_iNa_h_last;
L3I_iK_n_last = p.L3I_iK_n_IC+p.L3I_iK_IC_noise*rand(1,p.L3I_Npop);
L3I_iK_n = zeros(nsamp,p.L3I_Npop);
L3I_iK_n(1,:) = L3I_iK_n_last;
L1E_v_last = zeros(1,p.L1E_Npop);
L1E_v = zeros(nsamp,p.L1E_Npop);
L1E_v(1,:) = L1E_v_last;
L1E_iNa_m_last = p.L1E_iNa_m_IC+p.L1E_iNa_IC_noise*rand(1,p.L1E_Npop);
L1E_iNa_m = zeros(nsamp,p.L1E_Npop);
L1E_iNa_m(1,:) = L1E_iNa_m_last;
L1E_iNa_h_last = p.L1E_iNa_h_IC+p.L1E_iNa_IC_noise*rand(1,p.L1E_Npop);
L1E_iNa_h = zeros(nsamp,p.L1E_Npop);
L1E_iNa_h(1,:) = L1E_iNa_h_last;
L1E_iK_n_last = p.L1E_iK_n_IC+p.L1E_iK_IC_noise*rand(1,p.L1E_Npop);
L1E_iK_n = zeros(nsamp,p.L1E_Npop);
L1E_iK_n(1,:) = L1E_iK_n_last;
L2E_v_last = zeros(1,p.L2E_Npop);
L2E_v = zeros(nsamp,p.L2E_Npop);
L2E_v(1,:) = L2E_v_last;
L2E_iNa_m_last = p.L2E_iNa_m_IC+p.L2E_iNa_IC_noise*rand(1,p.L2E_Npop);
L2E_iNa_m = zeros(nsamp,p.L2E_Npop);
L2E_iNa_m(1,:) = L2E_iNa_m_last;
L2E_iNa_h_last = p.L2E_iNa_h_IC+p.L2E_iNa_IC_noise*rand(1,p.L2E_Npop);
L2E_iNa_h = zeros(nsamp,p.L2E_Npop);
L2E_iNa_h(1,:) = L2E_iNa_h_last;
L2E_iK_n_last = p.L2E_iK_n_IC+p.L2E_iK_IC_noise*rand(1,p.L2E_Npop);
L2E_iK_n = zeros(nsamp,p.L2E_Npop);
L2E_iK_n(1,:) = L2E_iK_n_last;
L3E_v_last = zeros(1,p.L3E_Npop);
L3E_v = zeros(nsamp,p.L3E_Npop);
L3E_v(1,:) = L3E_v_last;
L3E_iNa_m_last = p.L3E_iNa_m_IC+p.L3E_iNa_IC_noise*rand(1,p.L3E_Npop);
L3E_iNa_m = zeros(nsamp,p.L3E_Npop);
L3E_iNa_m(1,:) = L3E_iNa_m_last;
L3E_iNa_h_last = p.L3E_iNa_h_IC+p.L3E_iNa_IC_noise*rand(1,p.L3E_Npop);
L3E_iNa_h = zeros(nsamp,p.L3E_Npop);
L3E_iNa_h(1,:) = L3E_iNa_h_last;
L3E_iK_n_last = p.L3E_iK_n_IC+p.L3E_iK_IC_noise*rand(1,p.L3E_Npop);
L3E_iK_n = zeros(nsamp,p.L3E_Npop);
L3E_iK_n(1,:) = L3E_iK_n_last;
Input1_v_last = zeros(1,p.Input1_Npop);
Input1_v = zeros(nsamp,p.Input1_Npop);
Input1_v(1,:) = Input1_v_last;
Input1_iNa_m_last = p.Input1_iNa_m_IC+p.Input1_iNa_IC_noise*rand(1,p.Input1_Npop);
Input1_iNa_m = zeros(nsamp,p.Input1_Npop);
Input1_iNa_m(1,:) = Input1_iNa_m_last;
Input1_iNa_h_last = p.Input1_iNa_h_IC+p.Input1_iNa_IC_noise*rand(1,p.Input1_Npop);
Input1_iNa_h = zeros(nsamp,p.Input1_Npop);
Input1_iNa_h(1,:) = Input1_iNa_h_last;
Input1_iK_n_last = p.Input1_iK_n_IC+p.Input1_iK_IC_noise*rand(1,p.Input1_Npop);
Input1_iK_n = zeros(nsamp,p.Input1_Npop);
Input1_iK_n(1,:) = Input1_iK_n_last;
Input2_v_last =  5.6 * ones(1,p.Input2_Npop);
Input2_v = zeros(nsamp,p.Input2_Npop);
Input2_v(1,:) = Input2_v_last;
Input2_iNa_m_last = p.Input2_iNa_m_IC+p.Input2_iNa_IC_noise*rand(1,p.Input2_Npop);
Input2_iNa_m = zeros(nsamp,p.Input2_Npop);
Input2_iNa_m(1,:) = Input2_iNa_m_last;
Input2_iNa_h_last = p.Input2_iNa_h_IC+p.Input2_iNa_IC_noise*rand(1,p.Input2_Npop);
Input2_iNa_h = zeros(nsamp,p.Input2_Npop);
Input2_iNa_h(1,:) = Input2_iNa_h_last;
Input2_iK_n_last = p.Input2_iK_n_IC+p.Input2_iK_IC_noise*rand(1,p.Input2_Npop);
Input2_iK_n = zeros(nsamp,p.Input2_Npop);
Input2_iK_n(1,:) = Input2_iK_n_last;
L1I_L1E_iAMPA_s_last =  p.L1I_L1E_iAMPA_IC+p.L1I_L1E_iAMPA_IC_noise.*rand(1,p.L1E_Npop);
L1I_L1E_iAMPA_s = zeros(nsamp,p.L1E_Npop);
L1I_L1E_iAMPA_s(1,:) = L1I_L1E_iAMPA_s_last;
L1E_L1I_iGABA_s_last =  p.L1E_L1I_iGABA_IC+p.L1E_L1I_iGABA_IC_noise.*rand(1,p.L1I_Npop);
L1E_L1I_iGABA_s = zeros(nsamp,p.L1I_Npop);
L1E_L1I_iGABA_s(1,:) = L1E_L1I_iGABA_s_last;
L2I_L1I_iGABA_s_last =  p.L2I_L1I_iGABA_IC+p.L2I_L1I_iGABA_IC_noise.*rand(1,p.L1I_Npop);
L2I_L1I_iGABA_s = zeros(nsamp,p.L1I_Npop);
L2I_L1I_iGABA_s(1,:) = L2I_L1I_iGABA_s_last;
L1I_L2I_iGABA_s_last =  p.L1I_L2I_iGABA_IC+p.L1I_L2I_iGABA_IC_noise.*rand(1,p.L2I_Npop);
L1I_L2I_iGABA_s = zeros(nsamp,p.L2I_Npop);
L1I_L2I_iGABA_s(1,:) = L1I_L2I_iGABA_s_last;
L2E_L1E_iAMPA_s_last =  p.L2E_L1E_iAMPA_IC+p.L2E_L1E_iAMPA_IC_noise.*rand(1,p.L1E_Npop);
L2E_L1E_iAMPA_s = zeros(nsamp,p.L1E_Npop);
L2E_L1E_iAMPA_s(1,:) = L2E_L1E_iAMPA_s_last;
L1E_L2E_iAMPA_s_last =  p.L1E_L2E_iAMPA_IC+p.L1E_L2E_iAMPA_IC_noise.*rand(1,p.L2E_Npop);
L1E_L2E_iAMPA_s = zeros(nsamp,p.L2E_Npop);
L1E_L2E_iAMPA_s(1,:) = L1E_L2E_iAMPA_s_last;
L2I_L2E_iAMPA_s_last =  p.L2I_L2E_iAMPA_IC+p.L2I_L2E_iAMPA_IC_noise.*rand(1,p.L2E_Npop);
L2I_L2E_iAMPA_s = zeros(nsamp,p.L2E_Npop);
L2I_L2E_iAMPA_s(1,:) = L2I_L2E_iAMPA_s_last;
L2E_L2I_iGABA_s_last =  p.L2E_L2I_iGABA_IC+p.L2E_L2I_iGABA_IC_noise.*rand(1,p.L2I_Npop);
L2E_L2I_iGABA_s = zeros(nsamp,p.L2I_Npop);
L2E_L2I_iGABA_s(1,:) = L2E_L2I_iGABA_s_last;
L3E_L2E_iAMPA_s_last =  p.L3E_L2E_iAMPA_IC+p.L3E_L2E_iAMPA_IC_noise.*rand(1,p.L2E_Npop);
L3E_L2E_iAMPA_s = zeros(nsamp,p.L2E_Npop);
L3E_L2E_iAMPA_s(1,:) = L3E_L2E_iAMPA_s_last;
L3I_L2I_iGABA_s_last =  p.L3I_L2I_iGABA_IC+p.L3I_L2I_iGABA_IC_noise.*rand(1,p.L2I_Npop);
L3I_L2I_iGABA_s = zeros(nsamp,p.L2I_Npop);
L3I_L2I_iGABA_s(1,:) = L3I_L2I_iGABA_s_last;
L2E_L3E_iAMPA_s_last =  p.L2E_L3E_iAMPA_IC+p.L2E_L3E_iAMPA_IC_noise.*rand(1,p.L3E_Npop);
L2E_L3E_iAMPA_s = zeros(nsamp,p.L3E_Npop);
L2E_L3E_iAMPA_s(1,:) = L2E_L3E_iAMPA_s_last;
L2I_L3I_iGABA_s_last =  p.L2I_L3I_iGABA_IC+p.L2I_L3I_iGABA_IC_noise.*rand(1,p.L3I_Npop);
L2I_L3I_iGABA_s = zeros(nsamp,p.L3I_Npop);
L2I_L3I_iGABA_s(1,:) = L2I_L3I_iGABA_s_last;
L3I_L3E_iAMPA_s_last =  p.L3I_L3E_iAMPA_IC+p.L3I_L3E_iAMPA_IC_noise.*rand(1,p.L3E_Npop);
L3I_L3E_iAMPA_s = zeros(nsamp,p.L3E_Npop);
L3I_L3E_iAMPA_s(1,:) = L3I_L3E_iAMPA_s_last;
L3E_L3I_iGABA_s_last =  p.L3E_L3I_iGABA_IC+p.L3E_L3I_iGABA_IC_noise.*rand(1,p.L3I_Npop);
L3E_L3I_iGABA_s = zeros(nsamp,p.L3I_Npop);
L3E_L3I_iGABA_s(1,:) = L3E_L3I_iGABA_s_last;
L2E_Input1_iAMPA_s_last =  p.L2E_Input1_iAMPA_IC+p.L2E_Input1_iAMPA_IC_noise.*rand(1,p.Input1_Npop);
L2E_Input1_iAMPA_s = zeros(nsamp,p.Input1_Npop);
L2E_Input1_iAMPA_s(1,:) = L2E_Input1_iAMPA_s_last;
L2I_Input2_iAMPA_s_last =  p.L2I_Input2_iAMPA_IC+p.L2I_Input2_iAMPA_IC_noise.*rand(1,p.Input2_Npop);
L2I_Input2_iAMPA_s = zeros(nsamp,p.Input2_Npop);
L2I_Input2_iAMPA_s(1,:) = L2I_Input2_iAMPA_s_last;

% MONITORS:
L1I_tspike = -1e32*ones(2,p.L1I_Npop);
L1I_buffer_index = ones(1,p.L1I_Npop);
L1I_v_spikes = zeros(nsamp,p.L1I_Npop);
L2I_tspike = -1e32*ones(2,p.L2I_Npop);
L2I_buffer_index = ones(1,p.L2I_Npop);
L2I_v_spikes = zeros(nsamp,p.L2I_Npop);
L3I_tspike = -1e32*ones(2,p.L3I_Npop);
L3I_buffer_index = ones(1,p.L3I_Npop);
L3I_v_spikes = zeros(nsamp,p.L3I_Npop);
L1E_tspike = -1e32*ones(2,p.L1E_Npop);
L1E_buffer_index = ones(1,p.L1E_Npop);
L1E_v_spikes = zeros(nsamp,p.L1E_Npop);
L2E_tspike = -1e32*ones(2,p.L2E_Npop);
L2E_buffer_index = ones(1,p.L2E_Npop);
L2E_v_spikes = zeros(nsamp,p.L2E_Npop);
L3E_tspike = -1e32*ones(2,p.L3E_Npop);
L3E_buffer_index = ones(1,p.L3E_Npop);
L3E_v_spikes = zeros(nsamp,p.L3E_Npop);
Input1_tspike = -1e32*ones(2,p.Input1_Npop);
Input1_buffer_index = ones(1,p.Input1_Npop);
Input1_v_spikes = zeros(nsamp,p.Input1_Npop);
Input2_tspike = -1e32*ones(2,p.Input2_Npop);
Input2_buffer_index = ones(1,p.Input2_Npop);
Input2_v_spikes = zeros(nsamp,p.Input2_Npop);
L1E_L1I_iGABA_IGABA = zeros(nsamp,p.L1E_Npop);
  L1E_L1I_iGABA_IGABA(1,:)=(p.L1E_L1I_iGABA_gGABA.*(L1E_L1I_iGABA_s_last*L1E_L1I_iGABA_netcon).*(L1E_v_last-p.L1E_L1I_iGABA_EGABA));
L1E_L2E_iAMPA_IAMPA = zeros(nsamp,p.L1E_Npop);
